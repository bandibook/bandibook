- ì»¨í…ìŠ¤íŠ¸ëŠ” í•˜ìœ„ íŠ¸ë¦¬ì— ì „ì—­ ìƒíƒœë¥¼ ì œê³µí•  ìˆ˜ ìˆê³  ì»¨í…ìŠ¤íŠ¸ Providerë¥¼ ì¤‘ì²©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ë¦¬ì•¡íŠ¸ ìƒëª… ì£¼ê¸° ë‚´ì—ì„œ useStateì™€ ê°™ì€ í›…ìœ¼ë¡œ ì „ì—­ ìƒíƒœë¥¼ ì œì–´í•  ìˆ˜ ìˆë‹¤.
- ë°˜ë©´ êµ¬ë…ì„ ì‚¬ìš©í•˜ë©´ ë‹¨ì¼ ì»¨í…ìŠ¤íŠ¸ë¡œëŠ” ë¶ˆê°€ëŠ¥í•œ ë¦¬ë Œë”ë§ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

### ëª¨ë“ˆ ìƒíƒœì˜ í•œê³„

- ëª¨ë“ˆ ìƒíƒœëŠ” **ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì— ì¡´ì¬**
- ë•Œë¬¸ì— ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ë‚˜ í•˜ìœ„ íŠ¸ë¦¬ë§ˆë‹¤ ë‹¤ë¥¸ ìƒíƒœë¥¼ ê°€ì§ˆ ìˆ˜ ì—†ë‹¤ëŠ” í•œê³„

**`ğŸ¤” Contextë¥¼ ìƒê°í•´ë³¸ë‹¤ë©´?`**

- `Context`ì˜ ê²½ìš° `Provider`ë¥¼ í†µí•´ ê·¸ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ë¼ë¦¬ë§Œ ê³µìœ í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥
- ëª¨ë“ˆ ìƒíƒœì˜ ê²½ìš°ëŠ”
  - ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì™€ëŠ” ë¬´ê´€í•œ ì•„ì´ì´ë¯€ë¡œ.. íŠ¸ë¦¬ë§ˆë‹¤ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥

```jsx
const Counter = () => {
  const [state, setState] = useStore(store);
  ...
};
```

### Contextì™€ êµ¬ë… íŒ¨í„´ ì‚¬ìš©í•˜ê¸°

- Contextë¥¼ ì‚¬ìš©í•´ ì „ì—­ ìƒíƒœ ê°’ì„ ì „íŒŒ â†’ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§
- êµ¬ë…ì„ ì´ìš©í•œ ëª¨ë“ˆ ìƒíƒœ â†’ ì „ì²´ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì— ëŒ€í•´ í•˜ë‚˜ì˜ ê°’ë§Œ ì œê³µ

ì´ ë‘˜ì„ í•¨ê»˜ ì‚¬ìš©í•œë‹¤ë©´ ë‘ ê°€ì§€ ë¬¸ì œì ì„ ê·¹ë³µí•  ìˆ˜ ìˆë‹¤.

ëª¨ë“ˆ ìƒíƒœë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©í•œ `createStore`

```jsx
const createStore = (initialState) => {
  let state = initalState;

  const callbacks = new Set();
  const getState = () => state;
  const setState = (nextState) => {
    state = typeof nextState === 'function' ? nextState(state) : nextState;
  };
  const subscribe = (callback) => {
    callbacks.add(callback);
    return () => {
      callbacks.delte(callback);
    };
  };

  return { getState, setState, subscribe };
};
```

Contextë¥¼ ìƒì„±í•˜ëŠ” `createContext`ë¡œ, ê¸°ë³¸ê°’ì„ `createStore`ë¡œ ì „ë‹¬í•œë‹¤.

```jsx
const StoreContext = createContext(createStore({ count: 0, text: 'hello' }));
```

ìŠ¤í† ì–´ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ `useSelector`ë¼ëŠ” í›…ì„ êµ¬í˜„í•œë‹¤.

```jsx
const useSelector = (selector) => {
  const store = useContext(StoreContext);

  return useSubscription(
    useMemo(
      () => ({
        getCurrentValue: () => selector(store.getState()),
        subscribe: store.subscribe,
      }),
      [store, selector],
    ),
  );
};
```

**`ğŸ¤” useSelector`**

- `useContext`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤í† ì–´ ê°’ì„ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œê³µ
- ê·¸ë ‡ì§€ë§Œ, `selector`ë¥¼ ì´ìš©í•˜ì—¬ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì‚¬ìš© ë° ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë„ë¡

ë‹¤ë§Œ, ëª¨ë“ˆ ìƒíƒœì™€ ë‹¤ë¥´ê²Œ Contextë¥¼ ì‚¬ìš©í•´ ìƒíƒœë¥¼ ê°±ì‹ í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•  í•„ìš”ê°€ ìˆë‹¤.

```jsx
const useSetState = () => {
  const store = useContext(StoreContext);
  return store.setState;
};
```

**`ğŸ¤” íŒ©í† ë¦¬ íŒ¨í„´ë¡œ ì‹¸ë§¤ë³´ì~`**

```jsx
export const createSelectContext = (contextName, defaultValues) => {
  const Context = createContext(defaultValues);

  const Provider = ({ children, ...contextValues }) => {
    const value = useMemo(() => contextValues, [...Object.values(contextValues)]);
    return <Context.Provider value={value}>{children}</Context.Provider>;
  };

  const useSelector = (selector) => {
    const context = useContext(Context);

    if (context == null) {
      throw new Error(`${contextName} must be used within ${contextName}.Provider`);
    }

    return useSubscription(
      useMemo(
        () => ({
          getCurrentValue: () => selector(store.getState()),
          subscribe: store.subscribe,
        }),
        [store, selector],
      ),
    );
  };

  const useSetState = () => {
    const store = useContext(StoreContext);
    return store.setState;
  };

  return [Provider, useSelector, useSetState];
};
```

ì‚¬ìš©í•  ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```jsx
export const ComponentParent = ({ count, text }) => {
  const FooContext = createContext('FooContext');

  export const [FooProvider, useFooContextSelector] = createSelectContext();

  return (
    <FooProvider count={count} text={text}>
      {children}
    </FooProvider>
  );
};
```

```jsx
export const ComponentChild = () => {
  const textFromCtx = useFooContextSelector(useCallback((state) => state.text, [])); // text ì™¸ì˜ í”„ë¡œí¼í‹°ë“¤í•˜ê³ ëŠ” ë¬´ê´€í•´ì§

  return <div>{textFromCtx}</div>;
};
```
