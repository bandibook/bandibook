> ëª¨ë“ˆí˜•ì´ëž€, ì„œë¡œ ì˜ì¡´ì„±ì´ ë‚®ì€ ê¸°ëŠ¥ë“¤ì´ ëª¨ë“ˆë¡œì¨ ì €ìž¥ëœ í˜•íƒœë¥¼ ì˜ë¯¸
> ì´ë²ˆ ìž¥ì—ì„œëŠ” ES5 ë¬¸ë²•ì„ ì‚¬ìš©í•˜ëŠ” AMD, CommonJS, UMD ë°©ì‹ì„ ì‚´íŽ´ë³¸ë‹¤.

## 10.1 ìŠ¤í¬ë¦½íŠ¸ ë¡œë”(script loader)

- ìžë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì„ ì›¹íŽ˜ì´ì§€ì— ë™ì ìœ¼ë¡œ ë¡œë“œí•˜ê±°ë‚˜ ì œì–´í•  ìˆ˜ ìžˆë„ë¡ í•´ì£¼ëŠ” ë„êµ¬ ë˜ëŠ” ë©”ì»¤ë‹ˆì¦˜
- ëª¨ë“ˆ ë¡œë”(module loader)ë¼ê³  ë¶€ë¥´ê¸°ë„ í•˜ëŠ” ë“¯
- ì˜ì¡´ì„± ì£¼ìž…ê³¼ ëª¨ë“ˆí™”ë¥¼ í•¨ê»˜ ì²˜ë¦¬

_**ðŸ¤” ìŠ¤í¬ë¦½íŠ¸ ë¡œë”ëŠ” ì™œ í•„ìš”í•œ ê²ƒ?**_

- ë¸Œë¼ìš°ì €ê°€ ì§€ì›í•˜ëŠ” ëª¨ë“ˆ í¬ë§·ê³¼, ìš°ë¦¬ê°€ ë¡œë“œí•˜ë ¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ì˜ í¬ë§·ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸
- ë¸Œë¼ìš°ì €ëŠ” `import/export`ê°€ ìžˆëŠ” `ESM`ë§Œ ì´í•´
  - ì§€ì›í•˜ì§€ ì•ŠëŠ” `AMD`, `CJS`ì„ ëƒ…ë‹¤ ì‚¬ìš©í•˜ë©´
  - ë¸Œë¼ìš°ì €ëŠ” ì´ê±¸ ì‹¤í–‰í•˜ì§€ ëª»í•¨ (`require is not defined`)
- ìŠ¤í¬ë¦½íŠ¸ ë¡œë”ëŠ”
  - ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¡œë“œí•˜ê³ 
  - ë‚´ë¶€ í¬ë©§ì„ í™•ì¸í•œ ë’¤ì— (CJSì¸ì§€ AMDì¸ì§€)
  - ì´ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì“¸ ìˆ˜ ìžˆëŠ” ë°©ì‹ìœ¼ë¡œ ê°ì‹¸ì„œ ìž˜ ì‹¤í–‰ì‹œì¼œì£¼ê²Œ ëœë‹¤.

## 10.2 AMD

- ëª¨ë“ˆê³¼ ì˜ì¡´ì„± ëª¨ë‘ë¥¼ **ë¹„ë™ê¸°ì ìœ¼ë¡œ ë¡œë“œ**í•  ìˆ˜ ìžˆë„ë¡ ì„¤ê³„ëœ ëª¨ë“ˆ ì •ì˜ ë°©ì‹
- ë¹„ë™ê¸°ì ì´ë©´ì„œë„ ë†’ì€ ìœ ì—°ì„± â†’ ê°œë°œ ê³¼ì •ì—ì„œ í”ížˆ ë°œìƒí•˜ëŠ” ì½”ë“œì™€ ëª¨ë“ˆ ê°„ ê¸´ë°€í•œ ê²°í•©ì„ ì¤„ì—¬ì£¼ëŠ” ë“±ì˜ ìž¥ì 

### ëª¨ë“ˆ ì•Œì•„ë³´ê¸°

- `define`
  - ì´ë¦„ì´ ìžˆëŠ” ëª¨ë“ˆ í˜¹ì€ ìµëª… ëª¨ë“ˆì„ ì •ì˜í•˜ëŠ” ë° ì‚¬ìš©
    ```js
    define(
        module_id, /* ì„ íƒ ì¸ìž */
        [dependencies], /* ì„ íƒ ì¸ìž */
        definition function {} /* ëª¨ë“ˆì´ë‚˜ ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ëŠ” í•¨ìˆ˜ */
    )
    ```
- `require`

  - ìµœìƒìœ„ ìžë°”ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ì´ë‚˜ ëª¨ë“ˆ ë‚´ì—ì„œ ì˜ì¡´ì„±ì„ ë™ì ìœ¼ë¡œ ê°€ì ¸ì˜¤ê³ ìž í•  ë•Œ ì‚¬ìš©

    ```js
    // "foo"ì™€ "bar"ë¥¼ ì™¸ë¶€ ëª¨ë“ˆì´ë¼ê³  ê°€ì •
    // ì´ ì˜ˆì œì—ì„œëŠ” ì™¸ë¶€ì—ì„œ ë¡œë“œëœ ë‘ ëª¨ë“ˆì´ ì½œë°± í•¨ìˆ˜ì˜ ì¸ìžë¡œ ì „ë‹¬
    require(['foo', 'bar'], function (foo, bar) {
      // ë‚˜ë¨¸ì§€ ì½”ë“œ
      foo.doSomething();
    });

    // ðŸ”˜ ë™ì ìœ¼ë¡œ ë¡œë„ë”˜ ì˜ì¡´ì„±
    define(function (require) {
      var isReady = false,
        foobar;

      // ëª¨ë“ˆ ë‚´ë¶€ì—ì„œ requireë¥¼ í†µí•´ ì˜ì¡´ì„±ì„ ê°€ì ¸ì˜¨ë‹¤
      require(['foo', 'bar'], function (foo, bar) {
        isReady = true;
        foobar = foo() + bar();
      });

      // ì´ë ‡ê²Œ ã„¹ëª¨ë“ˆì„ ë°˜í™˜
      return {
        isReady: isReady,
        foobar: foobar,
      };
    });
    ```

## 10.3 CommonJS

- ì„œë²„ ì‚¬ì´ë“œì—ì„œ ëª¨ë“ˆì„ ì„ ì–¸í•˜ëŠ” ê°„ë‹¨í•œ APIë¥¼ ì§€ì •í•˜ëŠ” ëª¨ë“ˆ ì œì•ˆ
- AMDì™€ ë‹¬ë¦¬ I/O, íŒŒì¼ ì‹œìŠ¤í…œ, í”„ë¡œë¯¸ìŠ¤ ë“± ë”ìš± ê´‘ë²”ìœ„í•œ ë²”ìœ„

### CommonJS ì‹œìž‘í•˜ê¸°

- AMDì™€ ë‹¬ë¦¬ CJSëŠ” ëª¨ë“ˆì„ í•¨ìˆ˜ë¡œ ê°ì‹¸ëŠ” ìž‘ì—…ì´ í•„ìš”í•˜ì§€ ì•Šë‹¤.
- `exports` ë³€ìˆ˜ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì— ë‚´ë³´ë‚´ê³ ìž í•˜ëŠ” ê°ì²´ë¥¼ ë‹´ëŠ”ë‹¤.
- `require` í•¨ìˆ˜ëŠ” ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ë‚´ë³´ë‚¸ ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ë•Œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë‹¤.

```js
// `package/lib` ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì˜¨ë‹¤.
var lib = require('package/lib');

// ëª¨ë“ˆ ë‚´ë¶€ ë¡œì§ì„ ì •ì˜
function foo() {
  lib.log('hello world');
}
// foo í•¨ìˆ˜ë¥¼ ë‹¤ë¥¸ ëª¨ë“ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆë„ë¡ ë‚´ë³´ë‚¸ë‹¤.
exports.foo = foo;
```

ðŸ‘‡ ìœ„ ì½”ë“œë¥¼ AMDë¡œ

```js
define(function (require) {
  var lib = require('package/lib');

  function foo() {
    lib.log('hello world');
  }

  return {
    foobar: foo,
  };
});
```

## 10.4 UMD

```js
define(function (require, exports, module) {
  var shuffler = require('lib/shuffle');
  exports.randomize = function (input) {
    return shuffler.shuffle(input);
  };
});
```

- ëª¨ë“ˆì— ì˜ì¡´ì„± ë°°ì—´ì´ ì—†ê³ , ì •ì˜ í•¨ìˆ˜ê°€ ìµœì†Œí•œ í•˜ë‚˜ ì´ìƒì˜ ë§¤ê°œë³€ìˆ˜ë¥¼ ê°€ì§ˆ ë•Œì—ë§Œ CommonJS ëª¨ë“ˆë¡œì¨ ìž‘ë™í•œë‹¤ëŠ” ì ì„ ìœ ì˜

## ê¶ê¸ˆí•œ ì  ì´ê²ƒì €ê²ƒ

**_ðŸ¤” Node.jsì—ì„œ requireë¡œ esm ëª¨ë“ˆì„ ë¡œë“œí•  ìˆ˜ ìžˆëŠ” ê¸°ëŠ¥ì„ ì œê³µ_**

> https://socket.dev/blog/require-esm-backported-to-node-js-20

- Node.jsì—ì„œ requireë¡œ ESMì„ ë¡œë“œí•  ìˆ˜ ìžˆë„ë¡ ì§€ì›í•œë‹¤ëŠ” ê²ƒì€
  - í˜¼í•© ì‚¬ìš©ì„ ê¶Œìž¥í•œë‹¤ëŠ” ì˜ë¯¸ë³´ë‹¤ëŠ” ë“€ì–¼ í¬ë§·ì˜ ì§€ì›ì„ ì¤„ì´ê³ , ESMìœ¼ë¡œ í†µì¼í•´ ë‚˜ê°€ë ¤ëŠ” í˜¸í™˜ì„± ì¡°ì¹˜ë¡œ ë³´ì¸ë‹¤.
  - ìž¥ê¸°ì ìœ¼ë¡œëŠ” ìƒˆë¡œìš´ ëª¨ë“ˆì€ ESMìœ¼ë¡œë§Œ ìž‘ì„±ë˜ê³ , ì ì°¨ CJSë¥¼ ì¤„ì´ë ¤ëŠ” ë°©í–¥ìœ¼ë¡œ ë³´ì´ê¸°ë„?

_**ðŸ¤” CJS vs ESM ì„±ëŠ¥ì°¨ì´?**_

> - https://stackoverflow.com/questions/71780629/is-there-any-performance-difference-in-es-modules-vs-common-js-modules-in-nodejs
> - https://vectoscalar.com/cjs-and-esm-modules-in-node-js-a-comparison-of-advantages-and-disadvantages/

<img src="https://github.com/user-attachments/assets/c7374982-92b7-43cf-a141-2107832e89ec" width="400" />
