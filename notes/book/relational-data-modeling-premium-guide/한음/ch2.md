# ch2. 데이터 모델링 기본 개념

## 2.1 관계형 데이터 모델(Relational Data Model)
- 관계형 데이터 모델은 다른 모델보다 이론이 잘 정립돼 있으며 데이터를 집합적으로 다루므로 조회가 편리하고 좋은 성능을 보인다
- 필자는 함수 종속(Functional Dependency)와 정규화(Normalization)된 모델이 관계형 모델이라 정의한다
- ~~릴레이션.. 어트리뷰트.. 튜플 등에 대한 개념은 넘어가도록하자~~
- 관계형 데이터베이스의 Relational은 릴레이션 때문에 붙여진 이름이다
- 조인을 통해서 데이터를 얻을 수 있으므로 데이터를 중복해서 저장하지 않도록 설계하는 것이 핵심이다
- 데이터 정합성과 성능 차원에서 관계형 데이터베이스가 가장 효과적이다

### 관계형 모델의 몇 가지 특징
- 튜플(각 행)은 유일해야 한다 (엔티티 무결성이 이에 해당한다)
- 어트리뷰트에는 유일한 값이 사용되어야 한다
- 릴레이션의 이름도 유일해야 한다
- 릴레이션이 정규화 되지 않으면 관계형 모델이라 할 수 없다
- 외래 식별자를 통해서 연관관계가 성립된다

### 엔터티 타입과 엔터티
- 엔터티 타입은 엔터티들의 집합(Set)
- 엔터티 타입에 속한 특정 튜플을 엔터티라고 한다
- 엔터티 타입은 동일한 어트리뷰트를 가진 엔터티의 집합이다
- 다만 엄격하게 구분할 필요는 없다

## 2.2 무결성(Integrity)
- 무결성은 데이터 값이 정확한 상태를 의미한다
- 정합성은 데이터가 서로 모순이 없이 일관되게 일치해야 한다는 의미이고 무결성은 데이터가 정확하고 안전해야 한다는 의미다
- 중복 데이터가 다 틀린 값으로 일치하면 정합성은 만족하지만 무결성을 만족하지 못한다

### 불완전한 데이터
- 데이터의 중복이 완전히 제거되더라도 불완전한 데이터는 사용될 수 있다
- 참조 무결성 제약의 생략이나 필요한 초기 값의 생략 등으로 불완전한 데이터가 생성될 수 있다
- 관계형 데이터베이스의 가장 큰 목표는 데이터 무결성을 높이는 것이다

### 무결성의 종류
- 엔터티 무결성(Entity Integrity)
  - 모든 인스턴스는 고유해야 하며 인스턴스를 대표하는 속성에는 널 값을 가지면 안된다
  - 엔티티 무결성은 식별자에 의해서 지켜질 수 있다
- 참조 무결성(Referential Integrity)
  - 외래 키(FK) 속성은 참조 대상 릴레이션의 기본 키(PK) 값과 일치하거나 NULL이어야 한다
  - 즉, 존재하는 값이거나 NULL이어야 한다
  - 외래 키 제약(FK Constraint)에 의해 보장된다
- 도메인 무결성(Domain Integrity)
  - 특정 속성은 같은 데이터 타입과 길이, 같은 널 여부, 같은 기본값, 같은 허용 값 등 동일한 범주의 값만이 존재해야한다
- 업무 무결성(Business Integrity)
  - 업무를 수행하는 방법이나 데이터를 처리하는 규칙
  - 물리적으로 강제하는 대표적인 방법에 트리거가 있다

### 물리적인 강제성으로 지켜지는 데이터 무결성
- 애플리케이션 로직보다 DBMS에서 강제하는 것이 좋다

| 제약          | 주요 무결성  |
|-------------|---------|
| Primary Key | 엔터티 무결성 |
| Unique | 엔터티 무결성 |
| Foreign Key |  참조 무결성 |
|Check | 도메인 무결성 |
|Default | 도메인 무결성 |
|Data Type | 도메인 무결성 |
|Not Null | 도메인 무결성 |
|Trigger | 업무 무결성 |

## 2.3 데이터베이스 라이프 사이클
1. 요구사항 분석 
    - DB에서 관리해야 하는 데이터를 도출, 분석
    - 주로 협업과 인터뷰를 통해 도출한다
2. 개념 모델링
   - 요구사항을 분석하고 나서 도출되는 데이터 측면의 결과물
   - 요구사항 분석과 독립된 단계로 보기 어렵다
   - UML 다이어그램으로 표현할 수 있지만 주로 ERD로 표현한다
   - 핵심 데이터를 대상으로 모델링을 수행하며 통합된 모델이 도출되어야 한다
3. 논리 모델링
   - 핵심 데이터 포함 모든 데이터로 모델링을 수행하는 단계
   - 가장 중요한 것은 정규화
   - 함수 종속에 의해 데이터를 분해하는 것이다
   - 정규화를 거친 엔터티는 엔터티 그 자체이다
   - 정규화 된 모델을 논리 모델이라 하며 무결성이 높아진다
4. 물리 설계
    - 논리 모델을 물리 모델로 매핑하고 분해하거나 합친다
    - 가능한 성능을 최적화 해야한다
    - 정규화가 완전히 끝난 후 비정규형을 고려한다
    - 인덱스 설계를 포함한다
5. 데이터베이스 구축
    - 물리 설계에서 도출된 여러 객체를 생성하는 단계
    - 보통 DBA가 수행한다

## 2.4 주제 영역(Subject Area)
- 주제 영역은 데이터 아키텍처의 최상위 단계로 비즈니스의 목표를 달성하는데 필요한 데이터 집합을 의미한다
- 주제 영역은 데이터 모델을 구축할 수 있는 훌륭한 기준이 된다
- 시스템이 점점 방대해지면 데이터 모델도 매우 크고 복잡해짖므로 주제 영역 별로 모델을 구축하면 모델이 간소화 된다

## 2.5 데이터 표준화
- 표준화란 일정한 기준에 따라 통일하는 것이다
- 데이터의 품질을 높이고 오류를 줄이고 관련자의 의사소통을 돕는다
- 표준화를 정의할 때 중욯산 것은 일관되도록 사용하는 것이다
- ex. 사원과 직원이 동일한 의미라면 한 단어만 사용해야 한다 --> 이음 동이어
- 혼란을 불러일으킬 수 있는 동음이의어 역시 사용하지 않는 것이 바람직하다

## 2.6 ERD(Entity Relationship Diagram)
- 관계형 모델은 주로 ERD로 표현한다
- 우선 엔터티를 배치하는 것이 중요하다
  - 상위 엔터티가 하위 엔터티의 위쪽에 있거나, 왼쪽에 배치하는 것이 좋다
- 교차 엔터티는 양쪽 엔터티 사이에 위치하는 것이 좋은데 상하로 위치하는 것보다 가독성이 좋다
- 엔터티에서 중요한 속성이나 자주 사용되는 속성은 엔터티 상단에 위치하는 것이 좋다
  - 단 일관된 속성 순서를 적용하는 것이 좋다
  - 성격이 유사하거나 같이 사용될 수 있는 속성은 같이 위치시킨다
  - 동시에 입력되거나 조회되는 속성도 같은 위치에 존재시킨다
- ERD에서 한번 정해진 배치는 바꾸지 않는 것이 좋다
- 관계선을 표현할 때는 관계선이 서로 얽히지 않도록 표현하고, 엔터티를 통과하지 않도록 한다
- 색상이나 밑줄, 취소선, 폰트 등을 이용하는 것도 좋은 방법이다